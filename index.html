<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéì Simulation R√©mun√©ration Formation</title>
    <style>
        /* Variables CSS France Travail */
        /* =====================================
        Variables globales
        ===================================== */
        :root {
            --primary-color: #5A7D9A;
            --secondary-color: #8FA6B3;
            --success-color: #4CAF7F;
            --info-color: #6CA0DC;
            --warning-color: #D9A66C;
            --text-color: #EAEAEA;
            --bg-color: #1E1E2E;
            --card-bg: #2A2A3D;
            --border-color: #3A3A50;
            --sidebar-width: 280px;
        }

        .light-theme {
            --text-color: #1E1E2E;
            --bg-color: #F5F5F7;
            --card-bg: #FFFFFF;
            --border-color: #D1D1D6;
        }

        .dark-theme {
            --text-color: #EAEAEA;
            --bg-color: #1E1E2E;
            --card-bg: #2A2A3D;
            --border-color: #3A3A50;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Marianne, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        /* =====================================
        Container principal
        ===================================== */
        .container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 2rem;
            gap: 2rem;
        }

        /* =====================================
        Sidebar
        ===================================== */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--card-bg);
            padding: 2rem;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
            position: sticky;
            top: 2rem;
            height: auto;
        }

        .sidebar h3 {
            color: var(--primary-color);
            margin: 1.5rem 0 0.5rem 0;
            font-size: 1.1rem;
        }

        .sidebar hr {
            border: none;
            border-top: 1px solid var(--border-color);
            margin: 1rem 0;
        }

        .sidebar ul {
            list-style: none;
            padding-left: 0;
        }

        .sidebar li {
            margin: 0.5rem 0;
        }

        .theme-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .theme-btn {
            padding: 0.6rem;
            border: 2px solid var(--border-color);
            background: var(--card-bg);
            color: var(--text-color);
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .theme-btn:hover, .theme-btn.active {
            background: var(--primary-color);
            color: #fff;
            border-color: var(--primary-color);
        }

        /* =====================================
        Main content
        ===================================== */
        .main-content {
            max-width: 900px;
            width: 100%;
        }

        /* Header */
        .main-header {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 20px;
            color: var(--text-color);
            text-align: center;
            margin-bottom: 2rem;
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .main-header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .main-header h3 {
            font-size: 1.2rem;
            opacity: 0.8;
        }

        /* =====================================
        Tabs
        ===================================== */
        .tabs {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }

        .tab {
            padding: 1rem 1.5rem;
            border-radius: 12px 12px 0 0;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            cursor: pointer;
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .tab:hover {
            background: rgba(92, 125, 154, 0.1);
        }

        .tab.active {
            background: var(--primary-color);
            color: #fff;
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }

        /* Contenu des tabs */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* =====================================
        FORMULAIRE COMPACT (TAILLES R√âDUITES)
        ===================================== */
        #tab-0 .form-container {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 16px;
            border: 1px solid var(--border-color);
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
            margin-bottom: 1.5rem;
        }

        #tab-0 .form-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            align-items: center;
            gap: 1.2rem;
            margin-bottom: 1.2rem;
            padding: 0.9rem;
            background: rgba(92, 125, 154, 0.03);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
            position: relative;
        }

        #tab-0 .form-group:hover {
            border-color: var(--primary-color);
            box-shadow: 0 2px 6px rgba(92, 125, 154, 0.08);
        }

        #tab-0 .form-group::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 3px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary-color), #8FA6B3);
            border-radius: 1.5px;
        }

        #tab-0 .form-group label {
            font-weight: 600;
            color: var(--text-color);
            font-size: 0.9rem;
            padding: 0.3rem 0;
            line-height: 1.4;
        }

        /* Options radio inline compactes */
        #tab-0 .inline-options {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            flex-wrap: wrap;
        }

        #tab-0 .inline-option {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.5rem 0.8rem;
            background: var(--card-bg);
            border: 1.5px solid var(--border-color);
            border-radius: 8px;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        #tab-0 .inline-option:hover {
            border-color: var(--primary-color);
            background: rgba(92, 125, 154, 0.05);
        }

        #tab-0 .inline-option input[type="radio"] {
            margin: 0;
            width: 14px;
            height: 14px;
            accent-color: var(--primary-color);
            cursor: pointer;
        }

        #tab-0 .inline-option label {
            font-weight: 500;
            font-size: 0.85rem;
            cursor: pointer;
            margin: 0;
            padding: 0;
        }

        /* Select compact */
        #tab-0 .select-group {
            position: relative;
            justify-self: end;
            width: 100%;
            max-width: 250px;
        }

        #tab-0 .select-group select {
            padding: 0.6rem 0.8rem;
            background: var(--card-bg);
            border: 1.5px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-color);
            font-size: 0.85rem;
            width: 100%;
            font-weight: 500;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%235A7D9A' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.8rem center;
            background-size: 10px;
            padding-right: 2.2rem;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        #tab-0 .select-group select:hover {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(92, 125, 154, 0.1);
        }

        #tab-0 .select-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(92, 125, 154, 0.15);
        }

        /* Grille radio compacte */
        #tab-0 .radio-grid-container {
            justify-self: end;
            width: 100%;
            max-width: 350px;
        }

        #tab-0 .radio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 0.5rem;
        }

        #tab-0 .radio-option {
            padding: 0.6rem 0.5rem;
            background: var(--card-bg);
            border: 1.5px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: 500;
            font-size: 0.8rem;
            min-height: 42px;
            position: relative;
            overflow: hidden;
        }

        #tab-0 .radio-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(to right, var(--primary-color), #8FA6B3);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        #tab-0 .radio-option:hover {
            border-color: var(--primary-color);
            background: rgba(92, 125, 154, 0.05);
        }

        #tab-0 .radio-option:hover::before {
            opacity: 1;
        }

        #tab-0 .radio-option input[type="radio"] {
            margin-right: 0.4rem;
            width: 13px;
            height: 13px;
            accent-color: var(--primary-color);
            cursor: pointer;
        }

        /* Grille sp√©ciale pour la derni√®re question */
        #tab-0 .form-group:last-child .radio-grid {
            grid-template-columns: repeat(4, 1fr);
        }

        /* Bouton submit compact */
        #tab-0 .submit-btn {
            background: linear-gradient(135deg, var(--primary-color) 0%, #4A6B8A 100%);
            color: white;
            border: none;
            padding: 0.9rem 1.5rem;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(92, 125, 154, 0.25);
            width: 100%;
            margin-top: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            letter-spacing: 0.3px;
        }

        #tab-0 .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 18px rgba(92, 125, 154, 0.35);
            background: linear-gradient(135deg, #4A6B8A 0%, var(--primary-color) 100%);
        }

        #tab-0 .submit-btn:active {
            transform: translateY(0);
            box-shadow: 0 3px 10px rgba(92, 125, 154, 0.25);
        }

        /* =====================================
        STYLE UNIFORME POUR LES R√âSULTATS
        ===================================== */
        #tab-0 .result-header {
            background: linear-gradient(135deg, var(--card-bg) 0%, rgba(92, 125, 154, 0.05) 100%);
            padding: 1.8rem;
            border-radius: 16px;
            text-align: center;
            margin: 1.5rem 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border: 1px solid var(--border-color);
            font-family: Marianne, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
        }

        #tab-0 .result-header h2 {
            font-size: 1.5rem;
            margin-bottom: 0.8rem;
            color: var(--primary-color);
            font-weight: 700;
        }

        #tab-0 .result-header h3 {
            font-size: 1.2rem;
            margin-bottom: 0.8rem;
            color: var(--text-color);
            font-weight: 600;
        }

        #tab-0 .result-header p {
            font-size: 0.95rem;
            line-height: 1.5;
            color: var(--text-color);
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }

        /* Section d√©tails */
        #tab-0 .simulation-details {
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: 16px;
            margin: 1.5rem 0;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            font-family: Marianne, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
        }

        #tab-0 .simulation-details h3 {
            font-size: 1.1rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-weight: 600;
            padding-bottom: 0.6rem;
            border-bottom: 1.5px solid var(--border-color);
        }

        /* Boxes d'information enrichies */
        #tab-0 .info-box,
        #tab-0 .success-box,
        #tab-0 .warning-box {
            padding: 1.2rem;
            border-radius: 12px;
            margin: 1rem 0;
            border: 1px solid var(--border-color);
            background: var(--card-bg);
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            font-family: Marianne, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
        }

        #tab-0 .info-box h4,
        #tab-0 .success-box h4,
        #tab-0 .warning-box h4 {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        #tab-0 .info-box p,
        #tab-0 .success-box p,
        #tab-0 .warning-box p {
            font-size: 0.9rem;
            line-height: 1.6;
            color: var(--text-color);
            margin-bottom: 0.8rem;
        }

        #tab-0 .info-box ul,
        #tab-0 .success-box ul,
        #tab-0 .warning-box ul {
            padding-left: 1.5rem;
            margin: 0.8rem 0;
        }

        #tab-0 .info-box li,
        #tab-0 .success-box li,
        #tab-0 .warning-box li {
            margin-bottom: 0.4rem;
            font-size: 0.88rem;
            line-height: 1.5;
        }

        #tab-0 .info-box strong,
        #tab-0 .success-box strong,
        #tab-0 .warning-box strong {
            color: var(--primary-color);
            font-weight: 600;
        }

        #tab-0 .info-box {
            border-left: 4px solid var(--info-color);
            background: linear-gradient(135deg, rgba(108, 160, 220, 0.08) 0%, rgba(108, 160, 220, 0.02) 100%);
        }

        #tab-0 .success-box {
            border-left: 4px solid var(--success-color);
            background: linear-gradient(135deg, rgba(76, 175, 127, 0.08) 0%, rgba(76, 175, 127, 0.02) 100%);
        }

        #tab-0 .warning-box {
            border-left: 4px solid var(--warning-color);
            background: linear-gradient(135deg, rgba(217, 166, 108, 0.08) 0%, rgba(217, 166, 108, 0.02) 100%);
        }

        /* Section montants */
        #tab-0 .montant-details {
            background: var(--card-bg);
            padding: 1.2rem;
            border-radius: 10px;
            margin: 0.8rem 0;
            border: 1px dashed var(--border-color);
        }

        #tab-0 .montant-details h5 {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--success-color);
            margin-bottom: 0.5rem;
        }

        #tab-0 .montant-details p {
            font-size: 0.88rem;
            line-height: 1.5;
            color: var(--text-color);
        }

        /* Bouton t√©l√©charger compact */
        #tab-0 .download-btn {
            background: linear-gradient(135deg, var(--success-color) 0%, #3D8F66 100%);
            color: white;
            border: none;
            padding: 0.9rem 1.5rem;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(76, 175, 127, 0.25);
            width: 100%;
            margin: 1.5rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            letter-spacing: 0.3px;
        }

        #tab-0 .download-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 18px rgba(76, 175, 127, 0.35);
            background: linear-gradient(135deg, #3D8F66 0%, var(--success-color) 100%);
        }

        /* Section r√©sum√© de situation */
        #tab-0 .situation-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.8rem;
            margin: 1rem 0;
        }

        #tab-0 .situation-item {
            background: var(--card-bg);
            padding: 0.9rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            box-shadow: 0 2px 6px rgba(0,0,0,0.03);
            transition: all 0.2s ease;
        }

        #tab-0 .situation-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.06);
        }

        #tab-0 .situation-item strong {
            color: var(--primary-color);
            font-weight: 600;
            display: block;
            margin-bottom: 0.3rem;
            font-size: 0.85rem;
        }

        #tab-0 .situation-item span {
            color: var(--text-color);
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* =====================================
        Footer
        ===================================== */
        .footer {
            text-align: center;
            padding: 1.5rem;
            color: var(--text-color);
            opacity: 0.7;
            font-size: 0.8rem;
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
        }

        /* =====================================
        Responsive
        ===================================== */
        @media (max-width: 1100px) {
            #tab-0 .form-group {
                grid-template-columns: 1fr;
                gap: 0.8rem;
            }
            
            #tab-0 .inline-options,
            #tab-0 .select-group,
            #tab-0 .radio-grid-container {
                justify-self: start;
                width: 100%;
                max-width: 100%;
            }
            
            #tab-0 .inline-options {
                justify-content: flex-start;
            }
            
            #tab-0 .form-group:last-child .radio-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                align-items: center;
                padding: 1rem;
                gap: 1rem;
            }

            .sidebar {
                width: 100%;
                top: 0;
                padding: 1.2rem;
            }

            .main-content {
                width: 100%;
            }
            
            .main-header {
                padding: 1.2rem;
            }

            .main-header h1 {
                font-size: 1.6rem;
            }

            .main-header h3 {
                font-size: 1rem;
            }

            .tabs {
                flex-direction: column;
                align-items: center;
                gap: 0.4rem;
            }

            .tab {
                width: 100%;
                padding: 0.8rem;
                font-size: 0.9rem;
            }
            
            #tab-0 .form-container {
                padding: 1.2rem;
            }
            
            #tab-0 .form-group {
                padding: 0.8rem;
            }
            
            #tab-0 .form-group:last-child .radio-grid {
                grid-template-columns: 1fr;
            }
            
            #tab-0 .inline-options {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            #tab-0 .inline-option {
                width: 100%;
                justify-content: center;
            }
            
            #tab-0 .radio-grid {
                grid-template-columns: 1fr;
            }
            
            #tab-0 .result-header {
                padding: 1.2rem;
            }

            #tab-0 .result-header h2 {
                font-size: 1.3rem;
            }

            #tab-0 .result-header h3 {
                font-size: 1.1rem;
            }
            
            #tab-0 .situation-summary {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body class="light-theme">
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <h3>üèõÔ∏è France Travail</h3>
            <hr>
            
            <h3>üåì Mode d'affichage</h3>
            <div class="theme-buttons">
                <button class="theme-btn active" onclick="setTheme('light', this)">‚òÄÔ∏è Clair</button>
                <button class="theme-btn" onclick="setTheme('dark', this)">üåô Sombre</button>
            </div>
            <p><strong>Th√®me actuel :</strong> <span id="current-theme">‚òÄÔ∏è Mode clair</span></p>
            
            <hr>
            <h3>üìû Contacts utiles</h3>
            <p><strong>France Travail</strong><br>
            üìû 3949 (appel non surtax√©)<br>
            üåê <a href="https://www.francetravail.fr" target="_blank" style="color: var(--primary-color);">francetravail.fr</a></p>
            <br>
            <p><strong>Formation R√©gion </strong><br>
            üö® Si le candidat √† l'ASS üö® <br> Merci de contacter la GDD, afin d'√©viter les trop-per√ßus </p>
            
            <h3>üìã Documents utiles</h3>
            <ul>
                <li>RIB et justificatifs</li>
                <li>Pi√®ce d'identit√©</li>
            </ul>
            
            <hr>
        </aside>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <div class="main-header">
                <h1>üéì Simulation & Informations ‚Äì Aides √† la Formation</h1>
                <h3>France Travail ‚Ä¢ R√©gions ‚Ä¢ Dispositif SFER</h3>
            </div>
            
            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="switchTab(0)">üéØ Simulation de r√©mun√©ration</button>
                <button class="tab" onclick="switchTab(1)">üìò Formations</button>
                <button class="tab" onclick="switchTab(2)">üí∂ R√©mun√©rations</button>
                <button class="tab" onclick="switchTab(3)">üåç Dispositif SFER</button>
                <button class="tab" onclick="switchTab(4)">üìù AIF & POE</button>
            </div>
            
            <!-- Tab 1: Simulation -->
            <div id="tab-0" class="tab-content active">
                <h2 style="margin-bottom: 1rem; font-size: 1.2rem; color: var(--primary-color);">üß≠ Simulation personnalis√©e</h2>
                
                <form id="simulation-form" class="form-container">
                    <!-- Question 1: ARE -->
                    <div class="form-group">
                        <label>Percevez-vous actuellement l'ARE (Allocation ch√¥mage) ?</label>
                        <div class="inline-options">
                            <div class="inline-option">
                                <input type="radio" name="are" id="are_oui" value="Oui" required>
                                <label for="are_oui">Oui</label>
                            </div>
                            <div class="inline-option">
                                <input type="radio" name="are" id="are_non" value="Non" required>
                                <label for="are_non">Non</label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Question 2: RSA -->
                    <div class="form-group">
                        <label>Percevez-vous actuellement le RSA (Revenu de Solidarit√© Active) ?</label>
                        <div class="inline-options">
                            <div class="inline-option">
                                <input type="radio" name="rsa" id="rsa_oui" value="Oui" required>
                                <label for="rsa_oui">Oui</label>
                            </div>
                            <div class="inline-option">
                                <input type="radio" name="rsa" id="rsa_non" value="Non" required>
                                <label for="rsa_non">Non</label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Question 3: Type de formation -->
                    <div class="form-group">
                        <label>Type de formation envisag√©e :</label>
                        <div class="select-group">
                            <select name="formation_type" required>
                                <option value="">S√©lectionnez une option</option>
                                <option value="POE">POE (Pr√©paration Op√©rationnelle √† l'Emploi)</option>
                                <option value="AIF">Aide Individuelle √† la Formation (AIF)</option>
                                <option value="CPF">Formation via Mon Compte Personnel de Formation (CPF)</option>
                                <option value="Formation R√©gion (ex : SFER)">Formation financ√©e par la R√©gion (ex : SFER)</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Question 4: Dur√©e formation -->
                    <div class="form-group">
                        <label>Dur√©e de la formation :</label>
                        <div class="radio-grid-container">
                            <div class="radio-grid">
                                <label class="radio-option">
                                    <input type="radio" name="formation_duree" value="> 40 heures" required> > 40 heures
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="formation_duree" value="‚â§ 40 heures" required> ‚â§ 40 heures
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Question 5: Droits ARE -->
                    <div class="form-group">
                        <label>Si vous percevez l'ARE, vos droits couvrent-ils toute la dur√©e de la formation ?</label>
                        <div class="radio-grid-container">
                            <div class="radio-grid" style="grid-template-columns: repeat(4, 1fr);">
                                <label class="radio-option">
                                    <input type="radio" name="droits_fin" value="Oui"> Oui
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="droits_fin" value="Non"> Non
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="droits_fin" value="Je ne sais pas"> Je ne sais pas
                                </label>
                                <label class="radio-option">
                                    <input type="radio" name="droits_fin" value="Non concern√©"> Non concern√©
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit" class="submit-btn">
                        <span>üîç</span> Lancer la simulation
                    </button>
                </form>
                
                <div id="results-container"></div>
            </div>
            
            <!-- Tab 2: Formations -->
            <div id="tab-1" class="tab-content">
                <h2>üéì Formations (France Travail & R√©gion)</h2>
                <div class="info-box">
                    <h3>üßç‚Äç‚ôÇÔ∏è √Ä qui s'adressent-elles ?</h3>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>En tant que demandeur d'emploi, vous pouvez suivre une formation agr√©√©e par France Travail.</li>
                        <li>Les formations peuvent √™tre financ√©es ou co-financ√©es par la <strong>R√©gion</strong> ou l'<strong>√âtat</strong>.</li>
                        <li>Elles s'inscrivent dans votre <strong>Projet Personnel d'Acc√®s √† l'Emploi (PPAE)</strong>.</li>
                    </ul>
                    
                    <h3 style="margin-top: 1.5rem;">üèóÔ∏è Typologie et conditions</h3>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li><strong>POE (Pr√©paration Op√©rationnelle √† l'Emploi)</strong> : Formation individuelle (POEI) ou collective (POEC) pour un poste pr√©cis ou un m√©tier en tension.</li>
                        <li><strong>CPF (Compte Personnel de Formation)</strong> : Utilisation de vos droits personnels, avec possibilit√© d'abondement par France Travail.</li>
                        <li><strong>AIF (Aide Individuelle √† la Formation)</strong> : Financement direct par France Travail apr√®s √©tude de votre dossier.</li>
                        <li><strong>Formation R√©gionale</strong> : financ√©e par le Conseil r√©gional, souvent labellis√©e SFER.</li>
                        <li>Une formation doit durer <strong>au moins 40 heures</strong> pour certaines r√©mun√©rations.</li>
                    </ul>
                    
                    <h3 style="margin-top: 1.5rem;">üéØ Objectifs</h3>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Acqu√©rir de nouvelles comp√©tences, se reconvertir ou renforcer son employabilit√©.</li>
                        <li>Souvent orient√©es vers des <strong>m√©tiers en tension</strong> (via la R√©gion ou France Travail).</li>
                        <li>POE : pr√©parer une embauche sp√©cifique dans une entreprise partenaire.</li>
                    </ul>
                </div>
            </div>
            
            <!-- Tab 3: R√©mun√©rations -->
            <div id="tab-2" class="tab-content">
                <h2>üí∂ R√©mun√©rations pendant ou apr√®s formation</h2>
                <div class="info-box">
                    <h3>Principaux dispositifs :</h3>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li><strong>AREF</strong> : Maintien de l'ARE pendant la formation (si ‚â• 40h et prescrite par France Travail).</li>
                        <li><strong>RFF (R√©mun√©ration de Fin de Formation)</strong> : si vos droits ARE/ASP ne couvrent pas toute la dur√©e de la formation.</li>
                        <li><strong>RFFT (R√©mun√©ration de Formation France Travail)</strong> : pour les non-indemnis√©s.</li>
                        <li><strong>RSFP (R√©mun√©ration des Stagiaires de la Formation Professionnelle)</strong> : via la R√©gion ou l'√âtat.</li>
                        <li><strong>R√©mun√©ration POE</strong> : maintien de l'ARE ou allocation France Travail selon le type de POE.</li>
                        <li>Autres : ARE-F, ASP-F, ATI-F selon situation.</li>
                    </ul>
                    
                    <h3 style="margin-top: 1.5rem;"><strong>üìä Pour les montants actualis√©s et bar√®mes en vigueur :</strong></h3>

                    <a href="https://votresite.fr/remunerations" target="_blank" style="color: var(--primary-color);">Consultez notre page d√©di√©e aux r√©mun√©rations</a></p>
                    
                    <h3 style="margin-top: 1.5rem;">üöó Autres aides :</h3>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Aides √† la mobilit√©, h√©bergement, repas selon situation.</li>
                        <li>Le versement d√©bute apr√®s l'attestation d'entr√©e en formation.</li>
                    </ul>
                </div>
            </div>
            
            <!-- Tab 4: SFER -->
            <div id="tab-3" class="tab-content">
                <h2>üåç Dispositif SFER ‚Äì Se Former pour un Emploi en R√©gion (Hauts-de-France)</h2>
                <div class="info-box">
                    <h3>üéØ Objectif</h3>
                    <p>Le <strong>SFER</strong> remplace le <strong>Programme R√©gional de Formation (PRF)</strong>.<br>
                    Il permet aux demandeurs d'emploi d'acc√©der √† des <strong>formations financ√©es √† 100% par la R√©gion</strong>.</p>
                    
                    <h3 style="margin-top: 1.5rem;">üë• Publics concern√©s</h3>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Demandeurs d'emploi majeurs inscrits √† France Travail.</li>
                        <li>Salari√©s en contrat aid√© ou √† temps partiel (&lt;24h/semaine).</li>
                        <li>Personnes en reconversion selon les cas.</li>
                    </ul>
                    
                    <h3 style="margin-top: 1.5rem;">üß≠ Parcours propos√©s</h3>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li><strong>D√©couverte</strong> : d√©finir ou confirmer un projet professionnel.</li>
                        <li><strong>Qualifiant</strong> : formation certifiante orient√©e m√©tier.</li>
                        <li><strong>Perfectionnement</strong> : modules courts pour renforcer les comp√©tences.</li>
                        <li><strong>Fili√®res d'avenir</strong> : secteurs strat√©giques (industrie, √©lectromobilit√©, b√¢timent durable‚Ä¶).</li>
                    </ul>
                    
                    <h3 style="margin-top: 1.5rem;">üí∂ Financement & r√©mun√©ration</h3>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Financement int√©gral par la <strong>R√©gion Hauts-de-France</strong>.</li>
                        <li>Gratuit pour le demandeur d'emploi.</li>
                        <li>Les indemnis√©s continuent √† percevoir leur <strong>ARE</strong> pendant la formation.</li>
                        <li>Les non-indemnis√©s peuvent percevoir une <strong>indemnisation ASP</strong>, selon crit√®res.</li>
                    </ul>
                    
                    <h3 style="margin-top: 1.5rem;">üìù D√©marches & conseils</h3>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>√ätre inscrit √† France Travail.</li>
                        <li>Avoir un projet professionnel valid√©.</li>
                        <li>V√©rifier que la formation est <strong>labellis√©e SFER</strong> et financ√©e par la R√©gion.</li>
                        <li>Respecter l'assiduit√© et d√©clarer sa situation chaque mois.</li>
                    </ul>
                </div>
            </div>
            
            <!-- Tab 5: AIF & POE -->
            <div id="tab-4" class="tab-content">
                <h2>üìù AIF & POE - Dispositifs France Travail</h2>
                
                <div class="info-box">
                    <h3>üéØ POE - Pr√©paration Op√©rationnelle √† l'Emploi</h3>
                    <p>La POE signifie <strong>Pr√©paration Op√©rationnelle √† l'Emploi</strong>. C'est un dispositif de formation pilot√© par France Travail qui permet d'acqu√©rir rapidement les comp√©tences n√©cessaires pour occuper un poste pr√©cis.</p>
                    
                    <h4 style="margin-top: 1.5rem;">1Ô∏è‚É£ POEI ‚Äì Pr√©paration Op√©rationnelle √† l'Emploi Individuelle</h4>
                    <p><strong>üéØ Objectif :</strong> Former une personne pour un poste pr√©cis dans une entreprise identifi√©e.</p>
                    <p><strong>üë• Pour qui ?</strong></p>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Demandeurs d'emploi inscrits √† France Travail</li>
                        <li>B√©n√©ficiaires du RSA, ASS, AREF, etc.</li>
                        <li>Personnes en reconversion</li>
                    </ul>
                    <p><strong>üè¢ Avec qui ?</strong> Une entreprise qui s'engage √† embaucher apr√®s la formation</p>
                    <p><strong>üìÑ Type de contrat apr√®s formation :</strong> CDI, CDD ‚â• 12 mois, Contrat de professionnalisation, Contrat d'apprentissage</p>
                    <p><strong>‚è± Dur√©e :</strong> Jusqu'√† 400 heures</p>
                    <p><strong>üí∞ R√©mun√©ration pendant la formation :</strong> Allocation France Travail (ARE, RFPE, etc.) - Pas de salaire, sauf cas particuliers</p>
                    <p><strong>‚úÖ Avantages :</strong> Tr√®s fort taux d'embauche, formation cibl√©e exactement sur le poste, s√©curisation de l'emploi</p>
                    
                    <h4 style="margin-top: 1.5rem;">2Ô∏è‚É£ POEC ‚Äì Pr√©paration Op√©rationnelle √† l'Emploi Collective</h4>
                    <p><strong>üéØ Objectif :</strong> Former un groupe de personnes pour des m√©tiers en tension (ceux qui recrutent beaucoup).</p>
                    <p><strong>üë• Pour qui ?</strong> Demandeurs d'emploi - Pas besoin d'entreprise pr√©cise au d√©part</p>
                    <p><strong>üè≠ Secteurs fr√©quents :</strong> Industrie, BTP, Logistique, Num√©rique, Aide √† la personne, H√¥tellerie-restauration</p>
                    <p><strong>üìÑ Embauche :</strong> Non garantie, mais tr√®s fr√©quente - Plusieurs entreprises partenaires recrutent √† la fin</p>
                    <p><strong>‚è± Dur√©e :</strong> En g√©n√©ral 300 √† 400 heures</p>
                    <p><strong>üí∞ R√©mun√©ration :</strong> Allocation France Travail - Formation 100% financ√©e</p>
                    <p><strong>‚úÖ Avantages :</strong> Acc√®s √† des m√©tiers qui recrutent, aucune avance de frais, bon taux de retour √† l'emploi</p>
                    
                    <h4 style="margin-top: 1.5rem;">3Ô∏è‚É£ Comment acc√©der √† une POE ?</h4>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>√ätre inscrit √† France Travail</li>
                        <li>Identifier : une entreprise (POEI) ou une formation POEC disponible</li>
                        <li>En parler √† son conseiller France Travail</li>
                        <li>Monter le dossier (financement + formation)</li>
                        <li>Entrer en formation</li>
                    </ul>
                    
                    <h4 style="margin-top: 1.5rem;">4Ô∏è‚É£ Points importants √† savoir</h4>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>‚úÖ Formation gratuite</li>
                        <li>‚úÖ Pas de dipl√¥me obligatoire (souvent)</li>
                        <li>‚úÖ Accessible en reconversion</li>
                        <li>‚úÖ Forte insertion professionnelle</li>
                        <li>‚ùå Rythme souvent intensif</li>
                        <li>‚ùå S√©lection possible (tests, entretiens)</li>
                    </ul>
                </div>
                
                <div class="info-box" style="margin-top: 2rem;">
                    <h3>üí∞ AIF - Aide Individuelle √† la Formation</h3>
                    <p>L'AIF est une aide financi√®re accord√©e au cas par cas par France Travail lorsque aucun autre financement n'est possible ou suffisant.</p>
                    
                    <h4 style="margin-top: 1.5rem;">1Ô∏è‚É£ Qu'est-ce que l'AIF ?</h4>
                    <p>Elle sert √† compl√©ter ou remplacer : le CPF, les financements R√©gion, les aides de branche ou d'OPCO.</p>
                    
                    <h4 style="margin-top: 1.5rem;">2Ô∏è‚É£ √Ä qui s'adresse l'AIF ?</h4>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>‚úÖ Demandeurs d'emploi inscrits √† France Travail</li>
                        <li>‚úÖ Personnes en reconversion professionnelle</li>
                        <li>‚úÖ B√©n√©ficiaires : ARE, ASS, RSA, RFPE, AREF</li>
                        <li>‚ùå Pas accessible aux salari√©s (sauf cas tr√®s particuliers via transition pro)</li>
                    </ul>
                    
                    <h4 style="margin-top: 1.5rem;">3Ô∏è‚É£ Quelles formations peuvent √™tre financ√©es ?</h4>
                    <p>La formation doit √™tre : professionnalisante, coh√©rente avec un projet d'emploi, r√©aliste sur le march√© du travail.</p>
                    <p><strong>Exemples de formations financ√©es :</strong></p>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Titre professionnel (TP)</li>
                        <li>Certificat / qualification</li>
                        <li>Permis (B, C, D‚Ä¶) si indispensable √† l'emploi</li>
                        <li>Formation courte d'adaptation au poste</li>
                        <li>Reconversion vers un m√©tier qui recrutent</li>
                    </ul>
                    <p><strong>‚ùå Formations refus√©es en g√©n√©ral :</strong></p>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Loisirs / d√©veloppement personnel</li>
                        <li>Formations sans d√©bouch√©s clairs</li>
                        <li>Projets non valid√©s par le conseiller</li>
                    </ul>
                    
                    <h4 style="margin-top: 1.5rem;">4Ô∏è‚É£ Montant de l'AIF</h4>
                    <p><strong>üí∞ Pas de plafond national fixe</strong><br>Le montant d√©pend : du co√ªt de la formation, de ton projet, de ton bassin d'emploi, des cofinancements possibles.</p>
                    <p>üëâ L'AIF peut : financer 100% de la formation ou compl√©ter le CPF si celui-ci est insuffisant.</p>
                    <p><strong>‚ö†Ô∏è Le paiement est fait directement √† l'organisme de formation, jamais √† la personne.</strong></p>
                    
                    <h4 style="margin-top: 1.5rem;">5Ô∏è‚É£ R√©mun√©ration pendant la formation</h4>
                    <p>Pendant une formation financ√©e par AIF, tu peux percevoir :</p>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>AREF (si tu touches l'ARE)</li>
                        <li>RFPE (si tu n'as plus de droits)</li>
                        <li>Maintien de certaines allocations</li>
                    </ul>
                    <p><strong>üëâ L'AIF finance la formation, pas la r√©mun√©ration.</strong></p>
                    
                    <h4 style="margin-top: 1.5rem;">6Ô∏è‚É£ Comment obtenir une AIF ? (√©tapes)</h4>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li><strong>üß≠ √âtape 1 :</strong> Projet professionnel clair (M√©tier vis√©, D√©bouch√©s r√©els, Coh√©rence avec ton profil)</li>
                        <li><strong>üìÑ √âtape 2 :</strong> Devis de formation (Organisme certifi√© Qualiopi, Programme d√©taill√©, Dates et co√ªt)</li>
                        <li><strong>ü§ù √âtape 3 :</strong> Validation par le conseiller (Entretien avec France Travail, Justification du besoin de formation)</li>
                        <li><strong>üíª √âtape 4 :</strong> Demande officielle (D√©p√¥t du dossier AIF, Instruction du dossier)</li>
                        <li><strong>‚è≥ R√©ponse en g√©n√©ral sous 2 √† 4 semaines</strong></li>
                    </ul>
                    
                    <h4 style="margin-top: 1.5rem;">7Ô∏è‚É£ Avantages et inconv√©nients</h4>
                    <p><strong>‚úÖ Avantages :</strong></p>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Formation gratuite ou quasi gratuite</li>
                        <li>Tr√®s utile pour les reconversions</li>
                        <li>Compl√©ment du CPF possible</li>
                        <li>Financement sur mesure</li>
                    </ul>
                    <p><strong>‚ùå Inconv√©nients :</strong></p>
                    <ul style="padding-left: 1.5rem; margin-top: 0.5rem;">
                        <li>Pas automatique</li>
                        <li>Dossier parfois refus√©</li>
                        <li>D√©lai de validation</li>
                        <li>Projet doit √™tre solide et justifi√©</li>
                    </ul>
                </div>
            </div>
            
            <!-- Footer -->
            <div class="footer">
                üõà Application informative <br>
                üìÖ Derni√®re mise √† jour : 13-01-2026 <br>
                Sources : France Travail, Service Public.
            </div>
        </main>
    </div>
    
    <!-- jsPDF library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <script>
        // Theme management
        function setTheme(theme, buttonElement) {
            document.body.classList.remove('light-theme', 'dark-theme');
            document.body.classList.add(theme + '-theme');
            localStorage.setItem('theme', theme);
            
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            if (buttonElement) {
                buttonElement.classList.add('active');
            }
            
            const themeText = document.getElementById('current-theme');
            if (themeText) {
                themeText.textContent = theme === 'light' ? '‚òÄÔ∏è Mode clair' : 'üåô Mode sombre';
            }
        }
        
        const savedTheme = localStorage.getItem('theme') || 'light';
        setTheme(savedTheme, null);
        
        // Attacher le formulaire
        function attachForm() {
            const form = document.getElementById('simulation-form');
            if (form) {
                const newForm = form.cloneNode(true);
                form.parentNode.replaceChild(newForm, form);
                
                newForm.addEventListener('submit', function(e) {
                    if (typeof window.handleSubmit === 'function') {
                        window.handleSubmit(e);
                    } else {
                        console.error('handleSubmit n\'est pas d√©finie');
                    }
                });
                return true;
            } else {
                console.warn('Formulaire non trouv√©');
                return false;
            }
        }
        
        // Chargement de la page
        window.addEventListener('load', function() {
            attachForm();
        });
        
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', attachForm);
        } else {
            attachForm();
        }
        
        // Tab switching
        function switchTab(index) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(`tab-${index}`).classList.add('active');
            document.querySelectorAll('.tab')[index].classList.add('active');
        }
        
        // Fonction pour convertir HTML en texte pour PDF
        function htmlToText(html) {
            if (!html) return '';
            
            let text = html
                .replace(/<br\s*\/?>/gi, '\n')
                .replace(/<p>/gi, '\n')
                .replace(/<\/p>/gi, '\n')
                .replace(/<ul>/gi, '\n')
                .replace(/<\/ul>/gi, '\n')
                .replace(/<li>/gi, '‚Ä¢ ')
                .replace(/<\/li>/gi, '\n')
                .replace(/<strong>/gi, '')
                .replace(/<\/strong>/gi, '')
                .replace(/<[^>]+>/g, '')
                .replace(/\n\s*\n/g, '\n')
                .trim();
            
            return text;
        }
        
        // Generate PDF am√©lior√© avec informations d√©taill√©es
        function generatePDF(are, rsa, formation_type, formation_duree, droits_fin, mainResult, mainDetails, resultBoxes) {
            let JsPDFClass;
            if (typeof window.jspdf !== 'undefined') {
                JsPDFClass = window.jspdf.jsPDF || (window.jspdf.default && window.jspdf.default.jsPDF) || window.jspdf;
            } else if (typeof window.jsPDF !== 'undefined') {
                JsPDFClass = window.jsPDF;
            } else {
                alert('Erreur : La biblioth√®que PDF n\'est pas charg√©e.');
                return null;
            }
            
            const doc = new JsPDFClass('p', 'mm', 'a4');
            
            const pageWidth = doc.internal.pageSize.width;
            const margin = 20;
            const contentWidth = pageWidth - (2 * margin);
            
            // En-t√™te √©l√©gant
            doc.setFillColor(90, 125, 154);
            doc.rect(0, 0, pageWidth, 40, 'F');
            
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(22);
            doc.setFont('helvetica', 'bold');
            doc.text('R√©sultat de simulation - Aides √† la Formation', margin, 25);
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            doc.text('France Travail ‚Ä¢ R√©gions ‚Ä¢ Dispositif SFER', margin, 32);
            doc.text(`G√©n√©r√© le : ${new Date().toLocaleDateString('fr-FR')}`, pageWidth - margin, 32, { align: 'right' });
            
            doc.setDrawColor(90, 125, 154);
            doc.setLineWidth(0.5);
            doc.line(margin, 45, pageWidth - margin, 45);
            
            let yPos = 60;
            
            // Section : R√©sultat de votre simulation
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(16);
            doc.setFont('helvetica', 'bold');
            doc.text('R√©sultat de votre simulation', margin, yPos);
            yPos += 10;
            
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            const cleanResult = mainResult.replace(/‚úÖ|‚ö†Ô∏è|‚ÑπÔ∏è|‚ùì/g, '').trim();
            doc.setTextColor(90, 125, 154);
            doc.text(cleanResult, margin, yPos);
            yPos += 8;
            
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(60, 60, 60);
            const lines = doc.splitTextToSize(mainDetails, contentWidth);
            doc.text(lines, margin, yPos);
            yPos += (lines.length * 6) + 15;
            
            // Section : Votre situation
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text('Votre situation :', margin, yPos);
            yPos += 10;
            
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            
            const infoData = [
                ['ARE (Allocation ch√¥mage) :', are],
                ['RSA (Revenu de Solidarit√© Active) :', rsa],
                ['Type de formation :', formation_type],
                ['Dur√©e de la formation :', formation_duree],
                ['Droits ARE couvrent toute la formation :', droits_fin]
            ];
            
            infoData.forEach(row => {
                if (yPos > 250) {
                    doc.addPage();
                    yPos = 20;
                }
                
                doc.setTextColor(90, 125, 154);
                doc.setFont('helvetica', 'bold');
                doc.text(row[0], margin + 5, yPos);
                
                doc.setTextColor(0, 0, 0);
                doc.setFont('helvetica', 'normal');
                doc.text(row[1], margin + contentWidth/2, yPos);
                
                yPos += 8;
            });
            
            yPos += 10;
            
            // Section : Informations d√©taill√©es
            if (yPos > 200) {
                doc.addPage();
                yPos = 20;
            }
            
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text('Informations d√©taill√©es :', margin, yPos);
            yPos += 10;
            
            // Ajouter les informations d√©taill√©es de la simulation
            if (resultBoxes && resultBoxes.length > 0) {
                resultBoxes.forEach((box, index) => {
                    if (box.type === 'montant-details') {
                        // Ne pas traiter les bo√Ætes de montant-details ici
                        return;
                    }
                    
                    if (yPos > 240) {
                        doc.addPage();
                        yPos = 20;
                    }
                    
                    // Titre de la bo√Æte
                    doc.setFontSize(12);
                    doc.setFont('helvetica', 'bold');
                    
                    // Couleur selon le type
                    if (box.type === 'success') {
                        doc.setTextColor(76, 175, 127); // Vert
                    } else if (box.type === 'warning') {
                        doc.setTextColor(217, 166, 108); // Orange
                    } else {
                        doc.setTextColor(108, 160, 220); // Bleu
                    }
                    
                    const cleanMessage = box.message.replace(/‚úÖ|‚ö†Ô∏è|‚ÑπÔ∏è|‚ùì/g, '').trim();
                    doc.text(cleanMessage, margin, yPos);
                    yPos += 8;
                    
                    // Contenu de la bo√Æte
                    doc.setFontSize(10);
                    doc.setFont('helvetica', 'normal');
                    doc.setTextColor(60, 60, 60);
                    
                    const boxContent = htmlToText(box.details);
                    if (boxContent) {
                        const contentLines = doc.splitTextToSize(boxContent, contentWidth);
                        doc.text(contentLines, margin, yPos);
                        yPos += (contentLines.length * 5) + 8;
                    }
                    
                    // Ligne s√©paratrice entre les bo√Ætes
                    if (index < resultBoxes.length - 1) {
                        doc.setDrawColor(200, 200, 200);
                        doc.line(margin, yPos, pageWidth - margin, yPos);
                        yPos += 10;
                    }
                });
            }
            
            // Section : Montant
            if (yPos > 220) {
                doc.addPage();
                yPos = 20;
            }
            
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text('Informations financi√®res :', margin, yPos);
            yPos += 10;
            
            // D√©terminer le type de r√©mun√©ration
            let remunerationType = '';
            if (formation_type === 'POE') remunerationType = 'POE';
            else if (formation_type === 'AIF') remunerationType = 'AIF';
            else if (formation_type === 'CPF') remunerationType = 'CPF';
            else if (formation_type.includes('R√©gion')) remunerationType = 'RSFP';
            else if (are === 'Oui' && formation_duree === '> 40 heures') remunerationType = 'AREF';
            else if (are === 'Non' && rsa === 'Non') remunerationType = 'RFFT';
            
            // Informations sur les montants
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(60, 60, 60);
            
            let montantInfo = '';
            switch(remunerationType) {
                case 'AREF':
                    montantInfo = "Montant : √âquivalent √† votre ARE actuelle\n\nD√©tails : Maintien de l'ARE pendant la formation si elle est prescrite par France Travail et dure au moins 40 heures.";
                    break;
                case 'RFF':
                    montantInfo = "Montant : Plafonn√©e √† 652,02 ‚Ç¨ / mois selon le d√©cret\n\nD√©tails : Pour les personnes dont les droits ARE s'√©puisent pendant la formation.";
                    break;
                case 'RFFT':
                    montantInfo = "Montant : De 224,68 ‚Ç¨ √† 769,49 ‚Ç¨ / mois (jusqu'√† 2 170 ‚Ç¨ pour travailleurs handicap√©s)\n\nD√©tails : Pour les demandeurs d'emploi non indemnis√©s suivant une formation prescrite par France Travail.";
                    break;
                case 'RSFP':
                    montantInfo = "Montant : Bar√®me indicatif :\n‚Ä¢ Moins de 18 ans: 220,92‚Ç¨/mois\n‚Ä¢ 18-25 ans: 561,68‚Ç¨/mois\n‚Ä¢ 26 ans+: 769,49‚Ç¨/mois\n\nD√©tails : Pour les formations financ√©es par la R√©gion ou l'√âtat.";
                    break;
                case 'POE':
                    montantInfo = "Montant : Allocation France Travail (ARE, RFPE, etc.)\n\nD√©tails : Pas de salaire (sauf cas particuliers). Formation 100% financ√©e.";
                    break;
                case 'AIF':
                    montantInfo = "Montant : Financement des frais de formation (100% ou compl√©ment)\n\nD√©tails : L'AIF finance la formation, pas la r√©mun√©ration. AREF possible si ARE et formation ‚â• 40h.";
                    break;
                case 'CPF':
                    montantInfo = "Montant : Utilisation des droits CPF + abondement possible par France Travail\n\nD√©tails : AREF possible si formation ‚â• 40h et prescrite par France Travail.";
                    break;
                default:
                    montantInfo = "Les informations financi√®res d√©pendent de votre situation sp√©cifique. Veuillez consulter votre conseiller France Travail pour des pr√©cisions.";
            }
            
            const montantLines = doc.splitTextToSize(montantInfo, contentWidth);
            doc.text(montantLines, margin, yPos);
            yPos += (montantLines.length * 5) + 15;
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'italic');
            doc.setTextColor(100, 100, 100);
            doc.text('Ces montants sont indicatifs et peuvent √©voluer. Source : France Travail.', margin, yPos);
            yPos += 10;
            
            // Section : Prochaines √©tapes
            if (yPos > 200) {
                doc.addPage();
                yPos = 20;
            }
            
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 0, 0);
            doc.text('Prochaines √©tapes :', margin, yPos);
            yPos += 10;
            
            const steps = [
                "Rechercher une formation aupr√®s d'un organisme de formation (OF)",
                "Rechercher une immersion professionnelle (PMSMP) si possible",
                "Preparer le curriculum vitae (CV)",
                "Preparer la lettre de motivation",
                "Actualiser sa situation chaque fin de mois une fois en formation",
                "Consulter votre conseiller France Travail pour valider votre projet"
            ];
            
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            doc.setTextColor(60, 60, 60);
            
            steps.forEach(step => {
                if (yPos > 250) {
                    doc.addPage();
                    yPos = 20;
                }
                
                doc.setTextColor(90, 125, 154);
                doc.text('‚Ä¢', margin, yPos);
                doc.setTextColor(60, 60, 60);
                
                const stepLines = doc.splitTextToSize(step, contentWidth - 5);
                doc.text(stepLines, margin + 5, yPos);
                
                yPos += (stepLines.length * 6) + 6;
            });
            
            // Pied de page
            const footerY = 280;
            doc.setDrawColor(200, 200, 200);
            doc.line(margin, footerY, pageWidth - margin, footerY);
            
            doc.setFontSize(8);
            doc.setTextColor(150, 150, 150);
            doc.setFont('helvetica', 'italic');
            doc.text('Document g√©n√©r√© par l\'application de simulation France Travail', margin, footerY + 5);
            doc.text('Informations √† caract√®re indicatif - Derni√®re mise √† jour : 13/01/2026', pageWidth - margin, footerY + 5, { align: 'right' });
            
            return doc;
        }
        
        // Variable globale pour stocker les donn√©es de simulation
        let simulationData = null;
        
        // Fonction pour g√©n√©rer des informations d√©taill√©es enrichies
        function generateDetailedInfo(are, rsa, formation_type, formation_duree, droits_fin) {
            let boxes = [];
            
            if (formation_type === 'POE') {
                boxes.push({
                    type: 'success',
                    message: 'üéØ POE - Pr√©paration Op√©rationnelle √† l\'Emploi',
                    details: 'Formation cibl√©e pour un poste pr√©cis (POEI) ou un m√©tier en tension (POEC).'
                });
                
                if (are === 'Oui' && formation_duree === '> 40 heures') {
                    boxes.push({
                        type: 'info',
                        message: 'üí∞ AREF - Maintien de l\'ARE',
                        details: 'Votre ARE est maintenue pendant toute la dur√©e de la POE.'
                    });
                    
                    boxes.push({
                        type: 'info',
                        message: 'üìã Conditions pour l\'AREF',
                        details: `
                            <ul>
                                <li>Formation prescrite par France Travail</li>
                                <li>Dur√©e minimale de 40 heures</li>
                                <li>Assiduit√© obligatoire</li>
                                <li>D√©claration mensuelle de situation</li>
                            </ul>
                        `
                    });
                } else if (rsa === 'Oui') {
                    boxes.push({
                        type: 'info',
                        message: 'üí∞ RSA maintenu',
                        details: 'Le RSA peut √™tre maintenu pendant la POE sous certaines conditions.'
                    });
                }
                
                boxes.push({
                    type: 'info',
                    message: '‚öôÔ∏è Processus POE',
                    details: `
                        <ul>
                            <li><strong>√âtape 1 :</strong> Identification du besoin en formation</li>
                            <li><strong>√âtape 2 :</strong> Signature de la convention tripartite</li>
                            <li><strong>√âtape 3 :</strong> Entr√©e en formation</li>
                            <li><strong>√âtape 4 :</strong> Suivi et √©valuation</li>
                            <li><strong>√âtape 5 :</strong> Embauche (POEI) ou recherche d'emploi (POEC)</li>
                        </ul>
                    `
                });
                
                boxes.push({
                    type: 'warning',
                    message: '‚ö†Ô∏è Points d\'attention',
                    details: `
                        <ul>
                            <li>La POE ne garantit pas l'embauche (sauf POEI avec engagement √©crit)</li>
                            <li>Rythme souvent intensif</li>
                            <li>S√©lection possible via tests et entretiens</li>
                            <li>Engagement d'assiduit√© requis</li>
                        </ul>
                    `
                });
                
            } else if (formation_type === 'AIF') {
                boxes.push({
                    type: 'info',
                    message: 'üí∞ AIF - Aide Individuelle √† la Formation',
                    details: 'Financement de formation au cas par cas par France Travail.'
                });
                
                if (are === 'Oui' && formation_duree === '> 40 heures') {
                    boxes.push({
                        type: 'success',
                        message: '‚úÖ AREF possible',
                        details: 'Maintien de votre ARE pendant la formation financ√©e par AIF.'
                    });
                    
                    boxes.push({
                        type: 'info',
                        message: 'üìä Montant AREF',
                        details: 'Identique √† votre ARE actuelle. Vous devez actualiser votre situation chaque mois.'
                    });
                }
                
                boxes.push({
                    type: 'info',
                    message: 'üìù Crit√®res d\'√©ligibilit√© AIF',
                    details: `
                        <ul>
                            <li>Formation professionnalisante</li>
                            <li>Coh√©rente avec votre projet professionnel</li>
                            <li>R√©aliste sur le march√© du travail local</li>
                            <li>Absence d\'autres financements possibles</li>
                            <li>Organisme de formation certifi√© Qualiopi</li>
                        </ul>
                    `
                });
                
                boxes.push({
                    type: 'info',
                    message: '‚è≥ D√©lais et d√©marches',
                    details: `
                        <ul>
                            <li><strong>D√©lai d\'instruction :</strong> 2 √† 4 semaines</li>
                            <li><strong>Pi√®ces √† fournir :</strong> devis, projet professionnel, CV</li>
                            <li><strong>Validation :</strong> par votre conseiller France Travail</li>
                            <li><strong>Paiement :</strong> direct √† l\'organisme de formation</li>
                        </ul>
                    `
                });
                
            } else if (formation_type === 'CPF') {
                boxes.push({
                    type: 'info',
                    message: 'üí≥ Formation via votre CPF',
                    details: 'Utilisation de vos droits CPF avec possibilit√© d\'abondement par France Travail.'
                });
                
                if (are === 'Oui' && formation_duree === '> 40 heures') {
                    boxes.push({
                        type: 'success',
                        message: '‚úÖ AREF possible',
                        details: 'Maintien de votre ARE si la formation est prescrite par France Travail.'
                    });
                }
                
                boxes.push({
                    type: 'info',
                    message: 'üìà Abondement CPF par France Travail',
                    details: `
                        <ul>
                            <li>Possible si vos droits CPF sont insuffisants</li>
                            <li>N√©cessite un avis favorable de votre conseiller</li>
                            <li>Formation doit √™tre √©ligible au CPF</li>
                            <li>Justification du projet professionnel requise</li>
                        </ul>
                    `
                });
                
                boxes.push({
                    type: 'warning',
                    message: '‚ö†Ô∏è Points importants CPF',
                    details: `
                        <ul>
                            <li>V√©rifiez vos droits sur Mon Compte Formation</li>
                            <li>Certaines formations peuvent n√©cessiter un cofinancement</li>
                            <li>AREF uniquement si formation ‚â• 40h et prescrite</li>
                            <li>Conservez toutes les attestations et justificatifs</li>
                        </ul>
                    `
                });
                
            } else if (formation_type === 'Formation R√©gion (ex : SFER)') {
                boxes.push({
                    type: 'info',
                    message: 'üåç Formation r√©gionale SFER',
                    details: 'Formation financ√©e √† 100% par votre Conseil R√©gional.'
                });
                
                if (are === 'Oui') {
                    boxes.push({
                        type: 'success',
                        message: '‚úÖ Maintien de l\'ARE',
                        details: 'Vous continuez √† percevoir votre ARE pendant la formation r√©gionale.'
                    });
                } else if (rsa === 'Oui') {
                    boxes.push({
                        type: 'info',
                        message: 'üí∞ RSA maintenu',
                        details: 'Le RSA peut √™tre maintenu pendant une formation r√©gionale.'
                    });
                } else if (are === 'Non' && rsa === 'Non') {
                    boxes.push({
                        type: 'info',
                        message: 'üí∂ RSFP possible',
                        details: 'R√©mun√©ration des Stagiaires de la Formation Professionnelle selon bar√®me r√©gional.'
                    });
                    
                    boxes.push({
                        type: 'montant-details',
                        message: 'üìä Bar√®me indicatif RSFP',
                        details: `
                            <div class="montant-details">
                                <h5>Montants mensuels indicatifs :</h5>
                                <p>‚Ä¢ Moins de 18 ans : 220,92 ‚Ç¨</p>
                                <p>‚Ä¢ 18 √† 25 ans : 561,68 ‚Ç¨</p>
                                <p>‚Ä¢ 26 ans et plus : 769,49 ‚Ç¨</p>
                                <p>‚Ä¢ Travailleurs handicap√©s : jusqu'√† 2 170 ‚Ç¨</p>
                            </div>
                        `
                    });
                }
                
                boxes.push({
                    type: 'info',
                    message: 'üéØ Conditions SFER',
                    details: `
                        <ul>
                            <li>√ätre inscrit √† France Travail</li>
                            <li>Formation labellis√©e SFER</li>
                            <li>Projet professionnel valid√©</li>
                            <li>Respecter l'assiduit√©</li>
                            <li>D√©claration mensuelle de situation</li>
                        </ul>
                    `
                });
            }
            
            // Ajouter des informations communes
            boxes.push({
                type: 'info',
                message: 'üìû Prochaines d√©marches',
                details: `
                    <ul>
                        <li>Prendre rendez-vous avec votre conseiller France Travail</li>
                        <li>Pr√©parer votre projet professionnel d√©taill√©</li>
                        <li>Rechercher des formations √©ligibles</li>
                        <li>Rassembler les documents n√©cessaires (RIB, pi√®ce d'identit√©, justificatifs)</li>
                        <li>Actualiser r√©guli√®rement votre situation sur France Travail</li>
                    </ul>
                `
            });
            
            boxes.push({
                type: 'warning',
                message: '‚è∞ D√©lais √† respecter',
                details: `
                    <ul>
                        <li>Demande de financement : au moins 1 mois avant le d√©but de formation</li>
                        <li>D√©claration de situation : chaque fin de mois</li>
                        <li>Justificatifs d'assiduit√© : √† fournir selon les exigences</li>
                        <li>Actualisation France Travail : obligatoire m√™me en formation</li>
                    </ul>
                `
            });
            
            return boxes;
        }
        
        // Form submission
        window.handleSubmit = function(event) {
            event.preventDefault();
            
            const form = event.target;
            const formData = new FormData(form);
            const are = formData.get('are');
            const rsa = formData.get('rsa');
            const formation_type = formData.get('formation_type');
            const formation_duree = formData.get('formation_duree');
            const droits_fin = formData.get('droits_fin');
            
            if (!are || !rsa || !formation_type || !formation_duree || !droits_fin) {
                alert('Veuillez remplir tous les champs du formulaire.');
                return;
            }
            
            // Calculate results
            let mainResult = '';
            let mainDetails = '';
            
            // Logique de simulation principale
            if (formation_type === 'POE') {
                if (are === 'Oui' || rsa === 'Oui') {
                    mainResult = "‚úÖ Vous √™tes √©ligible √† une POE";
                    mainDetails = "La POE est accessible aux b√©n√©ficiaires de l'ARE et du RSA.";
                } else {
                    mainResult = "‚ÑπÔ∏è POE possible";
                    mainDetails = "La POE est accessible m√™me sans allocation sp√©cifique.";
                }
            } 
            else if (formation_type === 'AIF') {
                mainResult = "‚ÑπÔ∏è AIF - Aide Individuelle √† la Formation";
                mainDetails = "Financement de formation au cas par cas par France Travail.";
            }
            else if (formation_type === 'CPF') {
                mainResult = "‚ÑπÔ∏è Formation via votre CPF";
                mainDetails = "Utilisation de vos droits CPF avec possibilit√© d'abondement par France Travail.";
            }
            else if (formation_type === 'Formation R√©gion (ex : SFER)') {
                mainResult = "‚ÑπÔ∏è Formation r√©gionale";
                mainDetails = "Formation financ√©e √† 100% par votre Conseil R√©gional.";
            }
            
            // G√©n√©rer les informations d√©taill√©es enrichies
            const resultBoxes = generateDetailedInfo(are, rsa, formation_type, formation_duree, droits_fin);
            
            // Stocker les donn√©es pour le PDF
            simulationData = {
                are, rsa, formation_type, formation_duree, droits_fin,
                mainResult, mainDetails, resultBoxes
            };
            
            // Affichage des r√©sultats avec nouveau format enrichi
            const resultsContainer = document.getElementById('results-container');
            resultsContainer.innerHTML = `
                <div class="result-header">
                    <h2>üéØ R√©sultat de votre simulation</h2>
                    <h3>${mainResult}</h3>
                    <p>${mainDetails}</p>
                </div>
                
                <div class="simulation-details">
                    <h3>üìã D√©tails de votre situation</h3>
                    <div class="situation-summary">
                        <div class="situation-item">
                            <strong>ARE (Allocation ch√¥mage) :</strong>
                            <span>${are}</span>
                        </div>
                        <div class="situation-item">
                            <strong>RSA (Revenu de Solidarit√© Active) :</strong>
                            <span>${rsa}</span>
                        </div>
                        <div class="situation-item">
                            <strong>Type de formation :</strong>
                            <span>${formation_type}</span>
                        </div>
                        <div class="situation-item">
                            <strong>Dur√©e de la formation :</strong>
                            <span>${formation_duree}</span>
                        </div>
                        <div class="situation-item">
                            <strong>Droits ARE couvrent toute la formation :</strong>
                            <span>${droits_fin}</span>
                        </div>
                    </div>
                </div>
                
                <div class="simulation-details">
                    <h3>üí° Informations d√©taill√©es</h3>
                    ${resultBoxes.map(box => {
                        if (box.type === 'montant-details') {
                            return box.details;
                        } else {
                            return `
                                <div class="${box.type}-box">
                                    <h4>${box.message}</h4>
                                    ${box.details}
                                </div>
                            `;
                        }
                    }).join('')}
                </div>
                
                <button class="download-btn" id="download-pdf-btn">
                    <span>üìÑ</span> T√©l√©charger le r√©sultat en PDF
                </button>
            `;
            
            // Ajouter l'event listener pour le t√©l√©chargement PDF
            setTimeout(() => {
                const downloadBtn = document.getElementById('download-pdf-btn');
                if (downloadBtn) {
                    downloadBtn.onclick = () => {
                        if (simulationData) {
                            downloadPDF(
                                simulationData.are,
                                simulationData.rsa,
                                simulationData.formation_type,
                                simulationData.formation_duree,
                                simulationData.droits_fin,
                                simulationData.mainResult,
                                simulationData.mainDetails,
                                simulationData.resultBoxes
                            );
                        }
                    };
                }
            }, 100);
            
            resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        };
        
        // Fonction de t√©l√©chargement PDF
        window.downloadPDF = function(are, rsa, formation_type, formation_duree, droits_fin, mainResult, mainDetails, resultBoxes) {
            try {
                if (typeof window.jspdf === 'undefined' && typeof window.jsPDF === 'undefined') {
                    alert('La biblioth√®que PDF n\'est pas encore charg√©e. Veuillez patienter quelques secondes.');
                    return;
                }
                
                const doc = generatePDF(are, rsa, formation_type, formation_duree, droits_fin, mainResult, mainDetails, resultBoxes);
                if (doc) {
                    const fileName = `Simulation_Formation_${new Date().toISOString().slice(0,10)}.pdf`;
                    doc.save(fileName);
                }
            } catch (error) {
                console.error('Erreur lors de la g√©n√©ration du PDF:', error);
                alert('Erreur lors de la g√©n√©ration du PDF.');
            }
        };
    </script>
</body>
</html>
